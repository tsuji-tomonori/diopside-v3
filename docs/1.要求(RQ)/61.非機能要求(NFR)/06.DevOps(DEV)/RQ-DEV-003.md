---
id: RQ-DEV-003
title: テストカバレッジと回帰防止
doc_type: 非機能要求
phase: RQ
version: 1.0.0
status: 下書き
owner: RQ-SH-001
created: 2026-02-16
updated: '2026-02-16'
up:
- '[[RQ-SC-001]]'
related:
- '[[RQ-DEV-001]]'
- '[[RQ-INT-001]]'
- '[[RQ-DATA-001]]'
tags:
- diopside
- RQ
- DEV
---


## SnowCard（日本語）
- 要求ID: RQ-DEV-003
- 種別: 非機能要求
- 優先度: SHOULD
- 要求: 本システムは、ビジネスロジックのテストカバレッジ基準を維持し、JSON契約スキーマのcontract testと主要導線のE2Eスモークテストを実施すること。
- 根拠: 個人開発ではレビュー体制が限定的であり、自動テストによる回帰防止が品質維持の主要手段となるため。
- 受入基準:
  - ビジネスロジック（収集・変換・配信生成）の行カバレッジが70%以上である。
  - 配信JSON（`bootstrap`/`archive_index`/`tag_master`）のcontract testが存在し、スキーマ違反を検知できる。
  - 主要導線（トップページ表示→検索→結果表示）のE2Eスモークテストが存在する。
  - カバレッジとテスト結果がCIで自動計測され、閾値未達時にビルドが警告を出す。
- 例外/エラー:
  - インフラ層（CDKコンストラクト）はスナップショットテストで代替し、行カバレッジの対象外とする。
  - E2Eテストが外部依存（YouTube API）で不安定な場合は、モックを使用した準E2Eで代替する。
- 依存・関連:
  - [[RQ-DEV-001]]
  - [[RQ-INT-001]]
  - [[RQ-DATA-001]]

## 変更履歴
- 2026-02-16: 新規作成
