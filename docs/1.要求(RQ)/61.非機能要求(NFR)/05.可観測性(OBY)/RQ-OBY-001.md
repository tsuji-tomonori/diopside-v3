---
id: RQ-OBY-001
title: 可観測性要件
doc_type: 非機能要求
phase: RQ
version: 1.0.4
status: 下書き
owner: RQ-SH-001
created: 2026-01-31
updated: '2026-02-14'
up:
- '[[RQ-SC-001]]'
related:
- '[[RQ-RDR-023]]'
- '[[RQ-RDR-017]]'
- '[[RQ-RDR-035]]'
- '[[BD-SYS-QUAL-001]]'
- '[[BD-INF-MON-001]]'
- '[[BD-SYS-ADR-022]]'
- '[[DD-APP-LOG-001]]'
tags:
- diopside
- RQ
- OBY
---


## SnowCard（日本語）
- 要求ID: RQ-OBY-001
- 種別: 非機能要求
- 優先度: MUST
- 要求: 本システムは、収集・配信・検索・管理操作の状態を、構造化ログ/メトリクス/アラートで追跡可能にすること。
- 根拠: [[RQ-GL-011|再収集]]判断、障害切り分け、運用監査を同一証跡で実施するため、用途別ログ要件を固定する必要があるため。
- 受入基準:
  - ログは `operational` / `security` / `audit` の3区分で分類し、各イベントに `timestamp`、`event.name`、`event.outcome`、`severity`、`correlation_id` を記録する。
  - [[RQ-GL-002|収集実行]]ごとに `run_id`、開始/終了時刻、対象件数、成功件数、失敗件数を必須記録する。
  - 検索APIはステータスコード、応答時間、[[RQ-GL-014|検索条件]]種別を95%以上のリクエストで記録する。
  - 認証失敗、認可失敗、入力検証失敗、管理操作、設定変更は100%記録する。
  - 重大障害（連続失敗3回、可用率閾値未達）のアラート通知を5分以内に発報する。
  - CloudWatch Logsの保持期間は30日とし、31日目以降の詳細ログは自動削除される。
  - 必須フィールド充足率は99%以上、ログ欠測率は1%未満を維持する。
  - ログ運用コストは [[RQ-COST-001]] の月額上限内で維持する。
- 例外/エラー:
  - ログ出力失敗時はメトリクスで欠落件数を記録し、欠落率が1%を超えた場合は運用障害として扱う。
  - 監視基盤停止時は復旧後に欠測時間帯をレポートへ明記し、30日超過ログの再取得は行わない。
  - パスワード、トークン、セッションID、秘密鍵、PIIは平文で記録しない。
- 依存・関連:
  - [[RQ-RDR-035]]
  - [[RQ-RDR-017]]
  - [[BD-SYS-QUAL-001]]
  - [[BD-SYS-ADR-022]]
  - [[DD-APP-LOG-001]]

## 変更履歴
- 2026-02-10: 新規作成 [[RQ-RDR-017]]
- 2026-02-11: ログ必須項目/通知時間/保存期間の受入閾値を追加し、テンプレート記述を具体化 [[RQ-RDR-017]]
- 2026-02-11: コスト上限制約と両立するログ保持運用を明確化 [[RQ-RDR-023]]
- 2026-02-11: AWS Lambda前提の用途別ログ要件、30日保持/自動削除、禁止記録項目を追加 [[RQ-RDR-035]]
