---
id: review-report
title: ドキュメントレビューレポート
doc_type: レビュー報告
phase: RQ
version: 1.0.0
status: 下書き
owner: RQ-SH-001
created: 2026-02-15
updated: '2026-02-22'
up:
  - '[[RQ-SC-001]]'
related:
  - '[[RQ-RTM-001]]'
  - '[[RQ-RTM-002]]'
tags:
  - diopside
  - review
---

# [[RQ-GL-001|diopside]]-v3 ドキュメントレビューレポート

| 項目 | 値 |
|------|-----|
| レビュー日 | 2026-02-15 |
| 対象リポジトリ | [[RQ-GL-001|diopside]]-v3 |
| 対象ファイル数 | 385 |
| レビュー範囲 | 要求定義・基本設計・詳細設計・テスト計画 |

---

## 目次

1. [エグゼクティブサマリー](#1-エグゼクティブサマリー)
2. [要求の矛盾分析](#2-要求の矛盾分析)
3. [要求カバレッジ分析](#3-要求カバレッジ分析)
4. [基本設計の矛盾分析](#4-基本設計の矛盾分析)
5. [詳細設計の実装可能性分析](#5-詳細設計の実装可能性分析)
6. [インフラ重点分析](#6-インフラ重点分析)
7. [設計の曖昧さ一覧](#7-設計の曖昧さ一覧)
8. [テスト・運用文書の分析](#8-テスト運用文書の分析)
9. [改善提案](#9-改善提案)

---

## 1. エグゼクティブサマリー

### 総合評価: A-

[[RQ-GL-001|diopside]]-v3 のドキュメント群は、個人開発プロジェクトとしては極めて高い水準にある。要求定義から詳細設計・テスト計画まで全フェーズが体系的に整備されており、トレーサビリティマトリックス（RTM）による追跡も実現している。

| 指標 | 値 |
|------|-----|
| 分析対象ファイル | 385 |
| フェーズ区分 | 7（DOM/RQ/BD/DD/UT/IT/AT） |
| 重大指摘（Must Fix） | 5 件 |
| 改善提案（Should Fix） | 8 件 |
| 推奨事項（Nice to Have） | 5 件 |
| BD 内部整合性 | 良好（矛盾なし） |
| DD 実装可能性 | 高（一部要確認あり） |

**強み:**
- ドメインモデル・用語集・境界づけられたコンテキストが明確に定義されている
- インフラ設計（CIDR/SG/NACL/IaC パイプライン）が実装可能レベルで具体的
- [[RQ-GL-010|段階ロード]]（`bootstrap` → `tag_master` → `archive_index`）の一貫した設計
- バックアップ・リカバリ設計に RTO/RPO 目標が明示されている

**課題:**
- 要求間の論理的矛盾が 4 件存在
- テスト実行結果がすべてテンプレート状態
- 一部の非機能要求が[[RQ-PC-004|運用体制制約]]と整合しない

---

## 2. 要求の矛盾分析

### 矛盾 #1: 継続収集 vs コスト上限・常時監視なし

| 項目 | 内容 |
|------|------|
| 重要度 | **Medium** |
| 関連文書 | `1.要求(RQ)/01.プロジェクトの目的(PP)/[[RQ-PP-001]].md`, `1.要求(RQ)/12.プロジェクトの制約(PC)/[[RQ-PC-006]].md` |

**内容:**
[[RQ-PP-001]] はプロジェクト目的として「継続的に収集・蓄積」を定義しているが、[[RQ-PC-006]] は AWS 月額コストを 3,000 円に上限設定し、収集頻度の削減を優先事項としている。

**影響:**
「継続収集」の定義が曖昧なまま実装に進むと、コスト超過リスクまたは収集漏れのどちらかが発生する。

**推奨対応:**
[[RQ-PP-001]] に「継続収集」の定量的定義（例: 日次バッチ、週次バッチ）を追記し、[[RQ-PC-006]] のコスト制約との整合性を明示する。

---

### 矛盾 #2: 出演条件判定 vs 手動確認

| 項目 | 内容 |
|------|------|
| 重要度 | **Low** |
| 関連文書 | `1.要求(RQ)/51.機能要求(FR)/01.管理画面(ADM)/[[RQ-FR-003]].md`, `1.要求(RQ)/02.プロジェクトのスコープ(SC)/[[RQ-SC-001]].md` |

**内容:**
[[RQ-FR-003]] は「出演条件一致の公開動画を判定して取り込める」と記述し、管理画面での自動判定を示唆する。一方、[[RQ-SC-001]] のスコープ定義では[[RQ-SH-001|管理者]]による手動確認プロセスが前提となっている。

**影響:**
自動判定の精度と手動確認の必要性の関係が不明確。完全自動化と手動確認付きワークフローのどちらを実装すべきか判断できない。

**推奨対応:**
[[RQ-FR-003]] に「[[RQ-SH-001|管理者]]の確認を経て取り込む」フローを明記し、自動判定は候補提示にとどまることを明確化する。

---

### 矛盾 #3: [[RQ-GL-010|段階ロード]]無効化タイミング vs フィルタ即時動作

| 項目 | 内容 |
|------|------|
| 重要度 | **Medium** |
| 関連文書 | `1.要求(RQ)/31.ユースケース(UC)/[[RQ-UC-002]].md`, `1.要求(RQ)/51.機能要求(FR)/03.タグ管理(TAG)/[[RQ-FR-009]].md` |

**内容:**
[[RQ-UC-002]] は[[RQ-GL-010|段階ロード]]（`bootstrap` → `tag_master` → `archive_index`）を定義し、すべてのデータがロードされるまでフル絞り込みが無効となる。一方、[[RQ-FR-009]] はタグ条件による絞り込みが `tag_master` を参照して動作すると記述しており、`archive_index` ロード完了前のフィルタ動作が未定義。

**影響:**
`tag_master` ロード完了後〜`archive_index` ロード完了前の間にタグフィルタUIを有効化すべきかどうかが不明。

**推奨対応:**
[[RQ-UC-002]] に段階ごとの UI 状態遷移を明記する。特に `tag_master` ロード完了時点でタグフィルタを有効化するか否かを決定する。

---

### 矛盾 #4: 脆弱性即時対応 vs [[RQ-PC-004|運用体制制約]]

| 項目 | 内容 |
|------|------|
| 重要度 | **Medium** |
| 関連文書 | `1.要求(RQ)/61.非機能要求(NFR)/03.セキュリティ(SEC)/[[RQ-SEC-001-01]].md`, `1.要求(RQ)/12.プロジェクトの制約(PC)/[[RQ-PC-004]].md` |

**内容:**
[[RQ-SEC-001-01]] はリリース時に Critical/High 脆弱性をゼロにすることを受け入れ基準としているが、運用中に発見される脆弱性への対応時間は未定義。一方、[[RQ-PC-004]] は個人開発で 24 時間有人対応がないことを制約として明示している。

**影響:**
運用中に Critical 脆弱性が発見された場合の対応 SLA が定義されていないため、インシデント発生時の対応基準が不明確。

**推奨対応:**
[[RQ-SEC-001-01]] に運用中の脆弱性対応基準を追記する。例: 「Critical: 認知後 24 時間以内に緩和策適用、High: 72 時間以内にパッチ適用」とし、[[RQ-PC-004]] の個人運用制約と現実的に整合させる。

---

## 3. 要求カバレッジ分析

### 3.1 トレーサビリティ状況

要求 → 基本設計のトレーサビリティは RTM（`1.要求(RQ)/71.要求トレーサビリティマトリックス(RTM)/`）で管理されている。

| カテゴリ | 要求数 | BD 対応 | カバレッジ |
|----------|--------|---------|------------|
| 機能要求（FR） | 25+ | 対応あり | 高 |
| 非機能要求（NFR） | 10 カテゴリ | 対応あり | 高 |
| ユースケース（UC） | 9+ | 対応あり | 高 |
| 制約（PC） | 6+ | 設計判断に反映 | 中 |

### 3.2 未定義用語

以下の用語が文書内で使用されているが、用語集（`1.要求(RQ)/21.用語(GL)/`）に正式定義がない:

| 用語 | 使用箇所 | 影響 |
|------|----------|------|
| 運用サイクル | テスト計画文書 | テスト実行タイミングの解釈が曖昧 |
| 公開チャット | 要求文書 | YouTube ライブチャットとの区別が不明確 |
| 正規化 | データ設計文書 | DB 正規化か文字列正規化か不明 |

### 3.3 LLM 統合の未反映

| 項目 | 内容 |
|------|------|
| 重要度 | **Low** |
| 関連文書 | `1.要求(RQ)/31.ユースケース(UC)/[[RQ-UC-009]].md`, `1.要求(RQ)/51.機能要求(FR)/03.タグ管理(TAG)/[[RQ-FR-005]].md` |

[[RQ-UC-009]] は[[RQ-SH-001|管理者]]がタグ付けを行う際に「外部 LLM によるタグ提案」を利用するフローを定義している。しかし [[RQ-FR-005]]（[[RQ-GL-005|タグ辞書]]更新）には LLM 連携に関する記述がなく、機能要求レベルで LLM 統合が反映されていない。

**推奨対応:**
[[RQ-FR-005]] またはタグ管理の機能要求に LLM タグ提案機能の要求を追加する。あるいは、LLM 連携はユースケースレベルの運用手順であり機能要求対象外であることを明記する。

### 3.4 状態遷移図の欠如

以下の状態遷移が文書で言及されているが、状態遷移図が定義されていない:

- **[[RQ-GL-010|段階ロード]]の状態遷移**: `bootstrap` ロード中 → `tag_master` ロード中 → `archive_index` ロード中 → 完了。各段階での UI 状態・フィルタ有効範囲の遷移が図示されていない。
- **タグライフサイクル**: タグの作成 → 有効 → 無効化の遷移が DB 設計には暗示されているが、明示的な状態遷移図がない。

---

## 4. 基本設計の矛盾分析

### 4.1 BD 内部整合性: **良好（矛盾なし）**

基本設計文書群（`2.基本設計(BD)/`）内部で論理的矛盾は検出されなかった。以下の点で高い整合性を確認:

- アーキテクチャ概要（BD-SYS-ARCH）と個別設計文書の用語・構成が一致
- データ設計（BD-APP-DATA）と API 設計（BD-APP-API）のエンティティ定義が整合
- インフラ設計（BD-INF）と[[BD-SYS-QUAL-001|品質特性]]（BD-SYS-QUAL）の SLA 目標が整合

### 4.2 BD-DD アライメント: **良好**

詳細設計（`3.詳細設計(DD)/`）は基本設計を正しく拡張・具体化している:

- BD-APP-API で定義された API 仕様が DD-APP-API で詳細化されている
- BD-INF-IAC の IaC 方針が DD-INF-IAC で CI/CD パイプラインとして具体化されている
- BD-APP-DATA のデータモデルが DD-APP-DB で物理設計に落とし込まれている

---

## 5. 詳細設計の実装可能性分析

### 5.1 実装 Ready（そのまま実装可能）

| 領域 | 関連文書 | 評価 |
|------|----------|------|
| ネットワーク / IaC | `DD-INF-IAC-*`, `DD-INF-NET-*` | CIDR/SG/NACL が具体的に定義済み |
| API コントラクト | `DD-APP-API-*` | OpenAPI 相当の詳細定義あり |
| DB 制約 | `DD-APP-DB-*` | テーブル定義・インデックス・マイグレーション方針完備 |
| 監視 | `DD-INF-MON-*` | CloudFront 5xx WARN 2%/CRIT 5%、Lambda p95 WARN 1200ms/CRIT 1500ms 等の閾値定義済み |
| CI/CD | `DD-INF-IAC-001` | lint → policy → synth → diff → approve → deploy → smoke のパイプライン定義 |
| ログ | `DD-APP-ログ/` | 構造化ログの設計完了 |

### 5.2 要確認事項

| 項目 | 関連文書 | 内容 | 重要度 |
|------|----------|------|--------|
| DB バックアップ詳細 | `BD-INF-DEP-006` | PITR・日次スナップショットの方針は定義済みだが、リストア手順の実装レベル詳細が DD に不足 | **Medium** |
| `archive_index` ページネーション | `DD-APP-API-*` | ページ分割方式は定義されているが、1 ページあたりの件数・ソート順の詳細仕様が不明確 | **Low** |
| Lambda 同時実行制限 | `DD-INF-*` | 同時実行数の上限設定が明示されていない。コスト制約（3,000 円/月）との整合性要確認 | **Medium** |

---

## 6. インフラ重点分析

### 6.1 Critical 欠落

| 項目 | 内容 | 関連文書 |
|------|------|----------|
| RDS リストア手順の DD レベル詳細 | BD-INF-DEP-006 で PITR・スナップショットの方針は定義されているが、DD レベルでの具体的なリストアコマンド・手順書が未作成 | `BD-INF-DEP-006`, DD 該当文書なし |

> **補足:** バックアップ方針自体は BD-INF-DEP-006 で定義済み（S3 バージョニング 30 日、DB 日次スナップショット + PITR 30 日、RTO/RPO 目標あり）。不足しているのは DD レベルの実装手順。

### 6.2 Medium 欠落

| 項目 | 内容 | 関連文書 |
|------|------|----------|
| WAF ルール | Phase 2 として計画されているが、具体的なルールセットが未定義 | BD-INF-SEC 関連 |
| Lambda cold start SLA | コールドスタート時のレイテンシ目標が未定義。p95 WARN 1200ms に対してコールドスタートが含まれるか不明 | DD-INF-MON 関連 |
| シークレットローテーション頻度 | AWS Secrets Manager の利用は言及されているが、ローテーション間隔が未指定 | DD-INF-SEC 関連 |

### 6.3 Minor 欠落

| 項目 | 内容 |
|------|------|
| S3 ライフサイクルポリシー | バージョニングは 30 日と定義されているが、Glacier 移行等のライフサイクルルールが未定義 |
| TLS 証明書更新手順 | ACM による自動更新が前提と推測されるが明示されていない |
| クロスリージョン DR | DR/BCP 方針（BD-INF-PLAT-002）は存在するが、クロスリージョン構成の詳細は Phase 2 以降 |

### 6.4 良好な点

- **ネットワーク設計**: CIDR/SG/NACL が実装可能レベルで具体的に定義されている
- **監視閾値**: CloudFront 5xx（WARN 2% / CRIT 5%）、Lambda p95（WARN 1200ms / CRIT 1500ms）が明確
- **IaC パイプライン**: lint/validate → policy → cdk synth → cdk diff → approve → cdk deploy → smoke の全ステージが定義済み
- **破壊的変更の承認**: 設計レビュー + 運用の二重承認が要求されている

---

## 7. 設計の曖昧さ一覧

| # | 曖昧な点 | 関連領域 | 重要度 | 推奨対応 |
|---|----------|----------|--------|----------|
| 1 | トランザクション分離レベル未指定 | DD-APP-DB | **Medium** | PostgreSQL のデフォルト（Read Committed）を明示するか、要件に応じて Serializable を指定 |
| 2 | キャッシュ無効化エラーリカバリ未定義 | DD-INF / BD-INF | **Medium** | CloudFront invalidation 失敗時のリトライ・フォールバック戦略を定義 |
| 3 | LLM タグ提案のサーキットブレーカー未定義 | [[RQ-UC-009]] / DD-APP | **Low** | 外部 LLM API 障害時のフォールバック（手動タグ入力のみ）を明記 |
| 4 | 同時タグ更新の楽観ロック未言及 | DD-APP-DB | **Medium** | [[RQ-SH-001|管理者]]が単一のため影響は限定的だが、API レベルでの楽観ロック（ETag/version）を推奨 |
| 5 | `archive_index` ページネーション詳細未定義 | DD-APP-API | **Low** | 1 ページあたりの件数上限・ソート基準・次ページ取得方式を明記 |
| 6 | コスト / パフォーマンストレードオフの定量化なし | BD-SYS-QUAL / [[RQ-PC-006]] | **Low** | 3,000 円/月制約下での収集頻度・キャッシュ TTL のコスト試算を追加 |

---

## 8. テスト・運用文書の分析

### 8.1 テストケースの API 対応

| テストフェーズ | 計画文書 | ケース文書 | API カバレッジ |
|---------------|----------|-----------|---------------|
| 単体テスト（UT） | [[UT-PLAN-001]]〜005 | UT ケース（DOC/INF/FE/BE） | 全 14 API 対応 |
| 結合テスト（IT） | [[IT-PLAN-001]] | IT ケース（13 テストケース） | 全 14 API 対応 |
| 受入テスト（AT） | [[AT-PLAN-001]] | AT シナリオ（9 シナリオ） | 主要フロー対応 |

### 8.2 Critical 欠落: テスト実行結果

| 項目 | 内容 | 重要度 |
|------|------|--------|
| UT レポート | `4.単体テスト(UT)/51.単体テストレポート/` がテンプレート状態 | **Critical** |
| IT 結果 | `5.結合テスト(IT)/41.結合テスト結果/` がテンプレート状態 | **Critical** |
| AT 報告 | `6.受入テスト(AT)/61.受入テスト報告/` がテンプレート状態 | **Critical** |

> テスト計画・ケース定義は充実しているが、実行結果が一切記録されていない。これは開発フェーズの進行状況を反映している可能性があるが、リリース判定（[[AT-PLAN-001]] 参照）には全テストの実行結果が必要。

### 8.3 スタブ状態のテスト計画

| 文書 | 内容 | 状態 |
|------|------|------|
| [[UT-PLAN-002]] | ドキュメントドメイン | 最小限のケース定義のみ |
| [[UT-PLAN-003]] | インフラドメイン | 最小限のケース定義のみ |
| [[UT-PLAN-004]] | フロントエンドドメイン | 最小限のケース定義のみ |

### 8.4 テストデータ

- [[AT-PLAN-001]] は「最低 30 公式 + 30 ゲスト動画」のテストデータを要求
- テストデータフィクスチャ（固定テストデータセット）の定義が未完了
- `4.単体テスト(UT)/32.テストデータ設計/` および `5.結合テスト(IT)/32.テストデータ設計/` は存在するが詳細要確認

---

## 9. 改善提案

### 9.1 Must Fix（開発開始前に対応必須）— 5 件

| # | 提案 | 関連指摘 | 対応方法 |
|---|------|----------|----------|
| MF-1 | 「継続収集」の定量的定義を追加 | 矛盾 #1 | [[RQ-PP-001]] に収集頻度（日次/週次）を明記 |
| MF-2 | [[RQ-GL-010|段階ロード]]中の UI 状態遷移を定義 | 矛盾 #3 | [[RQ-UC-002]] に段階別 UI 状態表を追加 |
| MF-3 | 運用中の脆弱性対応 SLA を定義 | 矛盾 #4 | [[RQ-SEC-001-01]] に対応時間基準を追記 |
| MF-4 | DB リストア手順を DD レベルで作成 | インフラ Critical | DD-INF に復旧手順書を新規作成 |
| MF-5 | テストデータフィクスチャを定義 | テスト分析 8.4 | UT/IT のテストデータ設計を完成させる |

### 9.2 Should Fix（本番リリース前に対応推奨）— 8 件

| # | 提案 | 関連指摘 | 対応方法 |
|---|------|----------|----------|
| SF-1 | 出演条件判定フローの明確化 | 矛盾 #2 | [[RQ-FR-003]] に手動確認ステップを明記 |
| SF-2 | 未定義用語の用語集追加 | カバレッジ 3.2 | RQ-GL に「運用サイクル」「公開チャット」「正規化」を追加 |
| SF-3 | LLM 統合の要求レベル定義 | カバレッジ 3.3 | RQ-FR に LLM タグ提案の機能要求を追加 |
| SF-4 | トランザクション分離レベルの明示 | 曖昧さ #1 | DD-APP-DB に分離レベルを記載 |
| SF-5 | キャッシュ無効化リカバリ定義 | 曖昧さ #2 | DD-INF にリトライ・フォールバック戦略を追加 |
| SF-6 | 楽観ロックの設計追加 | 曖昧さ #4 | DD-APP-API に ETag ベースの同時更新制御を追加 |
| SF-7 | Lambda 同時実行制限の明示 | 実装可能性 5.2 | DD-INF に同時実行上限とコスト試算を追加 |
| SF-8 | [[UT-PLAN-002]]/003/004 の拡充 | テスト分析 8.3 | 各ドメインのテスト計画をケース数・カバレッジ目標含め拡充 |

### 9.3 Nice to Have（Phase 2 以降で対応）— 5 件

| # | 提案 | 関連指摘 | 対応方法 |
|---|------|----------|----------|
| NH-1 | 状態遷移図の作成 | カバレッジ 3.4 | [[RQ-GL-010|段階ロード]]・タグライフサイクルの状態遷移図を追加 |
| NH-2 | コスト / パフォーマンストレードオフ定量化 | 曖昧さ #6 | BD-SYS-QUAL にコスト試算セクションを追加 |
| NH-3 | WAF ルールセットの定義 | インフラ Medium | Phase 2 セキュリティ強化として具体化 |
| NH-4 | クロスリージョン DR 設計 | インフラ Minor | BD-INF-PLAT-002 を拡張 |
| NH-5 | `archive_index` ページネーション詳細 | 曖昧さ #5 | DD-APP-API にページサイズ・ソート仕様を追加 |

---

> 本レポートは [[RQ-GL-001|diopside]]-v3 リポジトリの `docs/` 配下 385 ファイルを対象に静的分析を行った結果である。指摘事項は文書内容の論理的整合性に基づいており、実装コードのレビューは含まない。

## 変更履歴
- 2026-02-15: frontmatter・文書IDリンクを整備
