---
id: BD-ADR-021
title: DB正本化と3層責務境界で検索拡張性を確保する
doc_type: アーキテクチャ決定記録
phase: BD
version: 1.0.1
status: 下書き
owner: RQ-SH-001
created: 2026-02-11
updated: '2026-02-11'
up:
- '[[RQ-RDR-034]]'
related:
- '[[RQ-DATA-001]]'
- '[[RQ-INT-001]]'
- '[[RQ-FR-005]]'
- '[[RQ-FR-025]]'
- '[[BD-ARCH-001]]'
- '[[BD-DATA-001]]'
- '[[BD-API-001]]'
- '[[BD-API-002]]'
- '[[BD-DEP-004]]'
- '[[DD-API-001]]'
- '[[DD-API-005]]'
tags:
- diopside
- BD
- ADR
---

## 決定事項
- 原本データの更新系は `管理画面 -> Backend API -> DB` を唯一経路とし、直接編集を許可しない。
- 利用者向け参照系は `利用者Web -> S3静的JSON` を当面の正規経路とし、検索時にDBへ直接問い合わせしない。
- 高度あいまい検索は将来 `API検索エンドポイント` を追加して段階導入する（本変更では契約詳細を固定しない）。
- 文書とテスト結果は配信経路を分離して公開し、業務API/運用APIの認証境界を維持する。

## 理由
- DB正本化でデータ整合と更新履歴の一貫性を維持しつつ、配信用生成物を独立運用できる。
- 静的JSON継続により、MVPの表示性能と配信コストの予見性を維持できる。
- 将来拡張点だけを先に確保することで、現行運用を壊さず検索機能を段階的に強化できる。

## 影響
- アーキテクチャ概要: [[BD-ARCH-001]] で更新系/参照系の分離と3層構造を明示する。
- データ設計: [[BD-DATA-001]] でDB正本、配信用生成、公開切替の責務境界を追加する。
- API設計: [[BD-API-001]] / [[BD-API-002]] で利用者向け配信契約と管理API契約を分離する。
- デプロイ設計: [[BD-DEP-004]] で配信経路分離（web/docs/openapi/api）と運用証跡配信を整理する。
- 詳細設計: [[DD-API-001]] / [[DD-API-005]] で境界追従を行う。
- 管理画面運用を成立させるため、[[DD-API-011]]〜[[DD-API-015]] を追加し、結果明細/再確認/タグ管理/公開runを分離する。

## 却下した選択肢
- すべてをリアルタイムAPI検索へ即時移行する案: 現行配信性能と運用安定性への影響が大きいため不採用。
- S3静的JSONを正本として継続する案: 更新系監査と将来の検索拡張時の整合管理が難しいため不採用。

## 変更履歴
- 2026-02-11: [[DD-API-011]]〜[[DD-API-015]]を追加し、管理系APIの責務分割を反映 [[BD-ADR-021]]
- 2026-02-11: 新規作成 [[BD-ADR-021]]
