---
id: UT-SEC-001
title: IaCセキュリティスキャンケース
doc_type: 単体テストケース
phase: UT
version: 1.0.2
status: 下書き
owner: RQ-SH-001
created: 2026-02-13
updated: '2026-02-14'
up:
- '[[UT-PLAN-001]]'
- '[[DD-INF-SEC-002]]'
related:
- '[[RQ-SEC-001-01]]'
tags:
- diopside
- UT
- INF
---

## 目的
- IaC定義の設定不備（暗号化未設定、公開設定、弱いTLS）を検出する。

## 入力条件
- 対象環境: `dev` と `prod`（`prod` 判定を正本、`dev` は事前是正用）。
- 対象設定: TLS、暗号化、公開アクセス、認証境界、ログ保持。
- スキャン定義はCIで固定化し、ローカル差分設定を禁止する。

## 手順
1. IaCセキュリティスキャンを `dev/prod` で実行する。
2. `Critical/High` を環境別に分類し、同一原因を束ねて記録する。
3. 該当設定の修正後に再スキャンし、再発有無を確認する。

## 失敗時判定
- `Critical` 1件以上で即NG。
- `High` 1件以上でNG（例外承認なし）。
- 同一設定種別で3回連続失敗した場合、設計文書（DD）改訂を必須化する。

## 期待結果
- Critical/High脆弱設定が0件である。

## 変更履歴
- 2026-02-14: 対象環境を `dev/prod` に統一し、判定方針を明確化
- 2026-02-13: 入力条件、実行手順、失敗時判定を追加
- 2026-02-13: 新規作成
