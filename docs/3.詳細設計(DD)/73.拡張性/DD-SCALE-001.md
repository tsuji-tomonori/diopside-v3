---
id: DD-SCALE-001
title: 拡張性詳細
doc_type: 拡張性設計
phase: DD
version: 1.0.2
status: 下書き
owner: RQ-SH-001
created: 2026-01-31
updated: '2026-02-11'
up:
- '[[BD-ARCH-001]]'
- '[[BD-DATA-001]]'
related:
- '[[RQ-PS-001]]'
- '[[RQ-AV-001]]'
- '[[RQ-PC-006]]'
- '[[RQ-DATA-001]]'
- '[[DD-PERF-001]]'
- '[[DD-AV-001]]'
- '[[AT-OPS-001]]'
- '[[UT-PLAN-001]]'
tags:
- diopside
- DD
- SCALE
---


## 詳細仕様
- MVP期間は常時稼働リソースを増やさず、静的配信最適化と[[RQ-GL-010|段階ロード]]で負荷増加に対応する。
- 拡張は「配信」「検索評価」「[[RQ-GL-002|収集ジョブ]]」の3系統に分離し、ボトルネック単位で段階的に適用する。

## スケール対象と戦略
| 対象 | 想定増加 | 一次対応 | 二次対応 |
| --- | --- | --- | --- |
| 配信トラフィック | 閲覧リクエスト増加 | CDNキャッシュTTL最適化、圧縮配信 | 配信経路のリージョン分散 |
| 一覧データ量 | `archive_index` ページ数増加 | ページ分割粒度の調整、先読み抑制 | 索引の世代分割 |
| 収集処理量 | 対象動画件数増加 | run単位の分割実行、再試行制御 | 並列ワーカー導入（上限付き） |

## 適用トリガ
- `archive_index.pN` の平均読込時間が 2.0 秒を連続3日超過した場合、ページ分割粒度を見直す。
- 収集runの処理時間が前月比 30% 以上増加した場合、run分割と対象優先順位の再設計を実施する。
- 月次コストが上限の 80% を超えた場合、キャッシュ期間と処理頻度を優先調整し、常時リソース増は最終手段とする。

## 縮退方針
- 補助表示（[[RQ-GL-016|コメント密度波形]]・[[RQ-GL-017|ワードクラウド]]）取得失敗時は主要導線を維持し、再試行導線を提示する。
- 管理系負荷が高い場合は手動起動と再実行を一時的に直列化し、重複実行を禁止する。
- 外部依存障害時は部分機能停止を許容し、失敗区分を明示して可用率計算から分離する。

## 監視と判定
- スケール関連SLIとして `配信レイテンシ`, `段階ロード遅延`, `収集run処理時間`, `再試行率` を日次記録する。
- 閾値超過時は改善アクションと実施期限を同時に記録し、翌リリースで効果確認を実施する。
- 改善未実施が2リリース継続した場合は技術負債として優先度を引き上げる。

## I/Oまたは責務
- 入力: 配信/検索/収集の負荷指標、月次コスト実績、可用性/性能判定結果、運用操作。
- 出力: スケール適用判断、縮退設定、運用アクション、次期改善計画。

## 変更履歴
- 2026-02-11: スケール対象、適用トリガ、縮退方針、監視判定を具体化
- 2026-02-10: 新規作成
