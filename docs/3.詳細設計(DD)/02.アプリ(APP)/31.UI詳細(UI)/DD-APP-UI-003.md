---
id: DD-APP-UI-003
title: フィルタドロワー
doc_type: UI詳細
phase: DD
version: 1.0.4
status: 下書き
owner: RQ-SH-001
created: 2026-01-31
updated: '2026-02-14'
up:
- '[[BD-APP-UI-002]]'
- '[[DD-APP-UI-001]]'
related:
- '[[RQ-FR-006]]'
- '[[RQ-FR-008]]'
- '[[RQ-UX-005]]'
- '[[DD-APP-ALG-001]]'
- '[[DD-APP-UI-012]]'
- '[[UT-PLAN-001]]'
tags:
- diopside
- DD
- UI
---


## 詳細仕様
- フィルタドロワー（[[DD-APP-UI-003|UI-U02]]）は[[RQ-GL-014|検索条件]]入力を集約し、確定操作まで一覧再評価を遅延させる。
- 端末幅390pxでは全画面ドロワー、768px以上ではサイドパネルとして表示する。
- 部品実装責務は [[DD-APP-UI-012|SearchConditionPanel]] で定義する。

## フィルタ項目
| 項目 | 入力形式 | バリデーション | 反映タイミング |
| --- | --- | --- | --- |
| キーワード | テキスト | 100文字以内 | 適用ボタン |
| タグ | 複数選択 | 最大20件 | 適用ボタン |
| 期間 | 日付範囲 | 開始<=終了 | 適用ボタン |
| 並び順 | 単一選択 | 列挙値のみ | 即時 |

## 操作フロー
1. ドロワー起動時に現行条件をフォームへ反映する。
2. 利用者が編集しても即時検索は行わず、`適用` で確定する。
3. `クリア` は初期条件へ戻し、`閉じる` は未確定変更を破棄する。

## 失敗時挙動
- [[RQ-GL-005|タグ辞書]]取得失敗時はタグ選択を無効化し、再取得ボタンを表示する。
- バリデーションエラー時は該当入力直下に理由を表示し、適用を禁止する。

## アクセシビリティ実装要件
- すべての入力は可視ラベルとプログラム上のラベル関連付け（`label for`/`id` または同等）を必須とする。
- バリデーションエラー時は対象入力へ `aria-invalid="true"` を付与し、エラーメッセージを `aria-describedby` で関連付ける。
- エラーメッセージ文言は「項目名 + 原因 + 修正方法」を1ブロックで提示する。
- ドロワー開閉時は開くボタンの `aria-expanded` とドロワー領域の `aria-controls` を同期する。
- [[RQ-GL-005|タグ辞書]]取得失敗や再取得結果は `role="status"` もしくは `aria-live="polite"` で通知し、フォーカス移動を強制しない。
- 入力エラー発生時は先頭エラー要素へフォーカス移動できる導線を提供し、キーボードのみで修正完結できること。

## I/Oまたは責務
- 入力: 現在[[RQ-GL-014|検索条件]]、[[RQ-GL-005|タグ辞書]]、利用者入力イベント。
- 出力: 確定済み[[RQ-GL-014|検索条件]]、入力エラー状態、一覧再評価トリガ。

## 変更履歴
- 2026-02-14: [[DD-APP-UI-012|SearchConditionPanel]] への参照を追加し、画面ID `UI-U02` を明記
- 2026-02-13: フォーム入力のアクセシビリティ属性要件（`aria-invalid`/`aria-describedby`/`aria-expanded`/status通知）を追加
- 2026-02-11: フィルタ項目、操作フロー、失敗時挙動を具体化
- 2026-02-10: 新規作成
