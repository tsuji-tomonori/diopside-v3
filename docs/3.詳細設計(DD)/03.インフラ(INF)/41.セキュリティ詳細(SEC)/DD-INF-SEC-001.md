---
id: DD-INF-SEC-001
title: DR復旧手順詳細
doc_type: インフラ詳細
phase: DD
version: 1.0.2
status: 下書き
owner: RQ-SH-001
created: 2026-02-13
updated: '2026-02-13'
up:
- '[[BD-INF-PLAT-002]]'
- '[[RQ-AV-001]]'
related:
- '[[AT-DR-001]]'
- '[[AT-RUN-001]]'
tags:
- diopside
- DD
- INF
---

## 詳細仕様
- 復旧シナリオを `サービス断`, `データ破損`, `認証障害` に分類する。
- 各シナリオで初動、切替、検証、復旧完了判定を定義する。

## 章構成
1. リソース別DR設定
2. シナリオ別Runbook
3. 判定・演習

## 1. リソース別DR設定
| リソース | DR設定値 | 目標値 | 根拠 |
|---|---|---|---|
| 配信経路（CloudFront/S3） | 直前安定版artifactで切戻し | RTO 30分以内 | 公開導線を最短で復旧し、利用者影響を抑えるため。 |
| データ保管（S3 version） | バージョン復元 + 差分照合 | RPO 0件欠損 | データ破損時に参照整合を担保するため。 |
| 認証基盤（Cognito/JWKS） | 設定復元 + トークン再検証 | 認証成功率99%以上 | 保護経路の誤遮断を回避するため。 |
| 監視/通知 | 復旧後5分以内に監視再有効化 | CRITICAL通知遅延5分以内 | 再障害の見逃しを防止するため。 |

## 2. シナリオ別Runbook
| シナリオ | 初動（0-5分） | 切替/復旧（5-20分） | 完了判定 |
|---|---|---|---|
| サービス断 | 監視確認、影響経路特定、告知開始 | 直前安定版へ切戻し、`/api/v1/health`確認 | 主要経路200応答、5xx率<1% |
| データ破損 | 破損範囲特定、更新停止 | S3バージョン復元、整合性検証 | 参照データ一致、差分0件 |
| 認証障害 | 認証基盤状態確認、影響API特定 | JWKS/設定復元、トークン検証再開 | 認証成功率99%以上 |

## 役割と責任
- インシデントコマンダー: 復旧方針決定、判定承認。
- オペレーター: 手順実行、証跡記録、進捗更新。
- レビュアー: 復旧完了判定の妥当性確認。

## 3. 判定・演習
### 依存順序
1. 認証基盤の健全性確認
2. 配信/API経路の復旧
3. 監視・アラート再有効化
4. [[AT-GO-001|リリース判定]]文書（[[AT-DR-001]]）更新

### 演習要件
- 四半期演習で所要時間を測定し、RTO/RPOとの差分を報告する。

## 変更履歴
- 2026-02-13: リソース別DR設定（配信/データ/認証/監視）と目標値根拠を追加
- 2026-02-13: シナリオ別Runbook、役割分担、依存順序、完了判定を具体化
- 2026-02-13: 新規作成
