---
id: DD-INF-DB-001
title: DBインフラ詳細設計
doc_type: インフラ詳細
phase: DD
version: 1.0.0
status: 下書き
owner: RQ-SH-001
created: 2026-02-21
updated: '2026-02-21'
up:
- '[[BD-INF-DEP-006]]'
- '[[RQ-AV-001]]'
related:
- '[[DD-APP-DB-002]]'
- '[[DD-INF-SEC-001]]'
- '[[AT-RUN-001]]'
tags:
- diopside
- DD
- INF
---

## 詳細仕様
- DBはアプリ正本データの保存先とし、配信JSONは派生データとして扱う。
- バックアップ方式は日次スナップショット + PITR（30日保持）を必須とする。

## 設計責務
| 領域 | 本書の責務 | 参照先 |
|---|---|---|
| インフラ設定 | バックアップ、復元、接続境界、運用制約 | [[BD-INF-DEP-006]] |
| データモデル | テーブル定義、整合制約、更新契約 | [[DD-APP-DB-002]] |
| 復旧手順 | 障害分類、初動、完了判定 | [[DD-INF-SEC-001]] |

## バックアップ/復元
| 項目 | 設定値 | 根拠 |
|---|---|---|
| スナップショット | 日次 | 日単位の復元点を確保するため。 |
| PITR | 有効（30日） | 誤更新時に直前時点へ巻き戻すため。 |
| 復元目標 | RTO 30分 / RPO 5分以内 | [[BD-INF-DEP-006]] の基準を満たすため。 |

## 接続境界
- DBは公開経路から直接到達させず、API実行基盤経由のみ接続を許可する。
- 資格情報はSecrets Managerで管理し、アプリ設定へ平文保存しない。

## 運用
- スキーマ変更とバックアップ設定変更は同一リリースで実施せず、障害時切戻し性を優先する。
- 復元訓練結果は運用証跡へ記録し、四半期ごとに見直す。

## 変更履歴
- 2026-02-21: 新規作成（DBバックアップ/PITR前提をDD-INFに明示） [[BD-SYS-ADR-036]]
