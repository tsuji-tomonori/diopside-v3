---
id: DD-NET-001
title: ネットワーク詳細設計
doc_type: インフラ詳細
phase: DD
version: 1.0.1
status: 下書き
owner: RQ-SH-001
created: 2026-02-13
updated: '2026-02-13'
up:
- '[[BD-INF-003]]'
- '[[RQ-SEC-001]]'
related:
- '[[IT-INF-NET-001]]'
- '[[AT-OPS-INF-001]]'
tags:
- diopside
- DD
- INF
---

## 詳細仕様
- サブネット、ルート、セキュリティルールを環境別に管理する。
- 管理面へのアクセスは許可元IPまたはゼロトラスト経路に限定する。

## ネットワーク設計値
| 項目 | dev | stg | prod | 備考 |
|---|---|---|---|---|
| VPC CIDR | `10.20.0.0/16` | `10.21.0.0/16` | `10.22.0.0/16` | 環境間重複禁止 |
| Public subnet | `10.x.0.0/24` | `10.x.0.0/24` | `10.x.0.0/24` | NAT/ALB配置用途 |
| Private app subnet | `10.x.10.0/24` | `10.x.10.0/24` | `10.x.10.0/24` | API/Lambda接続用途 |
| Private data subnet | `10.x.20.0/24` | `10.x.20.0/24` | `10.x.20.0/24` | DB/内部ストレージ用途 |

## セキュリティルール
- ingress: 公開経路は `443/tcp` のみ許可し、`80/tcp` は `443` へリダイレクトする。
- 管理面は `443/tcp` をゼロトラスト経路または許可元IP（運用固定CIDR）に限定する。
- egress: `443/tcp` のみ許可し、送信先は AWS API endpoint、監視基盤、認証基盤のallowlistに限定する。
- NACL: 明示denyルールを最終行で設定し、不要ポートの双方向通信を拒否する。
- TLS: 受信面は TLS 1.2 以上を必須とし、`TLS1.0/1.1` を無効化する。

## 変更管理
- ネットワーク変更は `plan` 差分で `route/security-group/nacl` の3点をレビュー必須とする。
- CIDR変更は破壊的変更として扱い、[[DD-CICD-INF-001]] の二重承認フローを適用する。

## 検証要件
- 許可経路/拒否経路の到達性テストを自動実行する。

## 変更履歴
- 2026-02-13: CIDR/サブネット/SG/NACL/egress/TLS最小要件を具体化
- 2026-02-13: 新規作成
