---
name: a11y-time-limits
description: セッションタイムアウト等の時間制限を伴うUIを設計・実装・改修するときに、WCAG 2.2 A/AA相当で延長/通知/救済を実装する
compatibility: opencode
metadata:
  standard: WCAG-2.2
  level: AA
  lang: ja
  area: time-limits
---

# a11y-time-limits

## 目的
時間制限（セッションタイムアウト、操作期限、通知自動消滅など）をアクセシブルに設計し、利用者が不利にならないようにします。
クラウドアプリではセキュリティ要件からタイムアウトが不可避な場合が多いため、WCAG要件に沿った **延長/解除/通知** の設計を標準化します。

## 対象となる達成基準（WCAG 2.2）
- 2.2.1 タイミング調整可能（A）
- 2.2.2 一時停止、停止、非表示（A）
- （関連）4.1.3 ステータスメッセージ（AA）、2.3.1 3回の閃光（A）

## このスキルを使う条件
- セッション失効、操作期限、通知自動消滅など、時間制限がUXや完了率に影響するUIを扱う
- タイムアウト前警告、延長操作、失効時のデータ救済を含む実装・レビューを行う
- 2.2.1/2.2.2 と 4.1.3 の整合を保ちながら設計判断を明文化したい

## このスキルを使わない条件
- 時間制限や自動更新/自動消滅が存在しない、静的な閲覧中心画面のみを扱う
- 主課題が時間制限ではなく、フォームエラー、フォーカス、コントラスト等で別スキルが中心になる

## 出力契約
- 対象フローごとに、時間制限の種別（セキュリティ/ビジネス/UI起因）と該当達成基準（2.2.1/2.2.2/4.1.3）への対応方針を示す
- 延長/解除/調整、警告通知、失効時の救済（データ保護・再開導線）の実装差分または修正案を提示する
- キーボード操作と支援技術通知を含む最小の検証結果（または実施手順）を残す

## 入力として必要な情報
- セッションタイムアウト時間、延長の可否、セキュリティ要件（法令/規程）
- 自動更新/自動遷移/自動消滅するUIの一覧（トースト、スライドショー、バナー等）
- 長時間作業が必要な画面（フォーム、申請、作成、編集等）

## 実施手順
### 1) 時間制限の種類を分類する
- セキュリティ起因（ログインセッション、再認証）
- ビジネス起因（予約枠、支払期限、オファー）
- UI起因（自動消滅通知、自動遷移）

### 2) タイミング調整（2.2.1）を満たす
以下のいずれか（または組合せ）を提供:
- 延長できる（Extend）
- 解除できる（Turn off）※セキュリティ要件に反する場合は不可
- 調整できる（Adjust）※少なくとも10倍などの目安を満たす設計を検討
- 例外（リアルタイム性等）を適用する場合は根拠を記録

**セッションタイムアウトの実装パターン**
- タイムアウト前に警告モーダルを表示し、延長操作を提供
- 延長操作はキーボードで可能、かつ状態変化が支援技術に伝わる（4.1.3）
- 入力中データは可能な範囲で自動保存（失効で消えない）

### 3) 自動更新/自動消滅UI（2.2.2）を制御可能に
- 動く/変わる/スクロールする/自動更新する要素に対して:
  - 一時停止（Pause）
  - 停止（Stop）
  - 非表示（Hide）
  のいずれかを提供する（必要に応じて）
- トースト通知の自動消滅:
  - 消える前に操作できる、または履歴から再確認できる
  - 重要通知は自動で消さない設計も検討

### 4) フォーカス・通知の扱い
- タイムアウト警告で突然フォーカスを奪う場合は、ユーザーを迷子にしないよう配慮
- スクリーンリーダー利用者にも警告が伝わるよう、適切なロール/ライブリージョンを使用

## 受入基準 / Definition of Done
- セッション/操作期限に対して、延長/通知/データ保護のいずれかの対策がある
- 自動消滅/自動更新UIに、停止/一時停止/非表示の手段がある（該当する場合）
- タイムアウト警告・状態変化が支援技術に伝わる

## 手動テスト手順（最小セット）
- タイムアウト前に警告が出て、キーボードで延長できる
- 長文入力中にタイムアウトしても、入力内容が失われない（または救済導線がある）
- トーストが消えても、重要情報を再確認できる

## よくある落とし穴
- タイムアウトで一方的にログアウトし、入力内容が消える
- 警告が視覚だけで、支援技術に伝わらない
- トーストが一瞬で消え、操作も再確認もできない
